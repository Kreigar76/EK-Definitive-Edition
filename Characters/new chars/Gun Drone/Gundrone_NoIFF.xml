<?xml version="1.0" encoding="utf-8"?>
<Override>
  <Character SpeciesName="Gundrone_noiff" Tags="ek_drone,ek_allied_drone,ek_recoverable_drone" SpeciesTranslationOverride="" DisplayName="Gundrone" Group="human" Humanoid="False" HasInfo="False" CanInteract="False" CanClimb="True" ForceSlowClimbing="False" Husk="False" HuskedSpecies="" NonHuskedSpecies="" UseHuskAppendage="False" NeedsAir="False" NeedsWater="False" UseHumanAI="False" IsMachine="False" CanSpeak="False" ShowHealthBar="True" UseBossHealthBar="False" Noise="250" Visibility="300" BloodDecal="" BleedParticleAir="blooddrop" BleedParticleWater="waterblood" BleedParticleMultiplier="1" CanEat="True" EatingSpeed="10" UsePathFinding="True" PathFinderPriority="1" HideInSonar="False" HideInThermalGoggles="False" SonarDisruption="0" DistantSonarRange="0" DisableDistance="25000" SoundInterval="10" DrawLast="False" AITurretPriority="1" AISlowTurretPriority="1" DespawnContainer="">
    <!-- Can't use character variant API because it causes the AI priorities to no longer function -->
    <ragdolls folder="%ModDir%/Characters/Gun Drone/Ragdolls/" />
    <animations folder="%ModDir%/Characters/Gun Drone/Animations/" />
    <health Vitality="100" DoesBleed="False" CrushDepth="Infinity" UseHealthWindow="False" BleedingReduction="0.9" BurnReduction="0" ConstantHealthRegeneration="0" HealthRegenerationWhenEating="0" StunImmunity="False" PoisonImmunity="True" PoisonVulnerability="0" EmpVulnerability="0" ApplyMovementPenalties="True" DieFromBeheading="True" AllowSeveringLegs="False" ApplyAfflictionColors="False" Immunities="" />
    <ai attackpriorityrooms="0" attackpriorityhumans="0" attackonlywhenprovoked="False" retaliatewhentakingdamage="True" CombatStrength="200" Sight="3" Hearing="2" MaxPerceptionDistance="-1" AggressionHurt="50" AggressionGreed="0" FleeHealthThreshold="0" AttackWhenProvoked="False" AvoidGunfire="False" DamageThreshold="0" AvoidTime="3" MinFleeTime="20" AggressiveBoarding="False" EnforceAggressiveBehaviorForMissions="True" TargetOuterWalls="True" RandomAttack="False" CanOpenDoors="False" UsePathFindingToGetInside="False" KeepDoorsClosed="False" AvoidAbyss="True" StayInAbyss="False" PatrolFlooded="False" PatrolDry="False" StartAggression="0" MaxAggression="100" AggressionCumulation="0" WallTargetingMethod="Target" PlayDeadProbability="0">
      <!--
    <targetpriority tag="stronger" state="Attack" priority="300" reactdistance="7500" />
    <targetpriority tag="weaker" state="Attack" priority="275" reactdistance="5000" />

	<targetpriority tag="Ekdronerallybeacon" state="Attack" priority="250" reactdistance="50000" attackdistance="2" />
    <targetpriority tag="human" state="Idle" priority="200" reactdistance="50000" />
	-->
      <!--<target tag="owner" state="Follow" priority="150" reactdistance="50" attackdistance="0" timer="0" />-->
      <target damagethreshold="5" Tag="owner" State="Protect" Priority="200" ReactDistance="50" AttackDistance="0" Timer="0" IgnoreContained="False" IgnoreInside="False" IgnoreOutside="False" IgnoreTargetInside="False" IgnoreTargetOutside="False" IgnoreIfNotInSameSub="False" IgnoreIncapacitated="False" Threshold="0" ThresholdMin="-1" ThresholdMax="-1" PerceptionDistanceMultiplier="1" MaxPerceptionDistance="-1" Offset="0,0" AttackPattern="Straight" PrioritizeSubCenter="False" SweepDistance="0" SweepStrength="10" SweepSpeed="1" CircleStartDistance="5000" IgnoreTargetSize="False" CircleRotationSpeed="1" DynamicCircleRotationSpeed="False" CircleRandomRotationFactor="0" CircleStrikeDistanceMultiplier="5" CircleMaxRandomOffset="0" />
      <target Tag="Ekdroneattackbeacon" State="Attack" Priority="300" ReactDistance="5000" AttackDistance="0" Timer="0" IgnoreContained="False" IgnoreInside="False" IgnoreOutside="False" IgnoreTargetInside="False" IgnoreTargetOutside="False" IgnoreIfNotInSameSub="False" IgnoreIncapacitated="False" Threshold="0" ThresholdMin="-1" ThresholdMax="-1" PerceptionDistanceMultiplier="1" MaxPerceptionDistance="-1" Offset="0,0" AttackPattern="Straight" PrioritizeSubCenter="False" SweepDistance="0" SweepStrength="10" SweepSpeed="1" CircleStartDistance="5000" IgnoreTargetSize="False" CircleRotationSpeed="1" DynamicCircleRotationSpeed="False" CircleRandomRotationFactor="0" CircleStrikeDistanceMultiplier="5" CircleMaxRandomOffset="0" />
      <target Tag="Ekdronerallybeacon" State="Follow" Priority="250" ReactDistance="200" AttackDistance="0" Timer="0" IgnoreContained="False" IgnoreInside="False" IgnoreOutside="False" IgnoreTargetInside="False" IgnoreTargetOutside="False" IgnoreIfNotInSameSub="False" IgnoreIncapacitated="False" Threshold="0" ThresholdMin="-1" ThresholdMax="-1" PerceptionDistanceMultiplier="1" MaxPerceptionDistance="-1" Offset="0,0" AttackPattern="Straight" PrioritizeSubCenter="False" SweepDistance="0" SweepStrength="10" SweepSpeed="1" CircleStartDistance="5000" IgnoreTargetSize="False" CircleRotationSpeed="1" DynamicCircleRotationSpeed="False" CircleRandomRotationFactor="0" CircleStrikeDistanceMultiplier="5" CircleMaxRandomOffset="0" />
      <target Tag="stronger" State="Attack" Priority="400" ReactDistance="1000" AttackDistance="1000" Timer="0" IgnoreContained="False" IgnoreInside="False" IgnoreOutside="False" IgnoreTargetInside="False" IgnoreTargetOutside="False" IgnoreIfNotInSameSub="False" IgnoreIncapacitated="False" Threshold="0" ThresholdMin="-1" ThresholdMax="-1" PerceptionDistanceMultiplier="1" MaxPerceptionDistance="-1" Offset="0,0" AttackPattern="Straight" PrioritizeSubCenter="False" SweepDistance="0" SweepStrength="10" SweepSpeed="1" CircleStartDistance="5000" IgnoreTargetSize="False" CircleRotationSpeed="1" DynamicCircleRotationSpeed="False" CircleRandomRotationFactor="0" CircleStrikeDistanceMultiplier="5" CircleMaxRandomOffset="0" />
      <target Tag="equal" State="Attack" Priority="400" ReactDistance="1000" AttackDistance="1000" Timer="0" IgnoreContained="False" IgnoreInside="False" IgnoreOutside="False" IgnoreTargetInside="False" IgnoreTargetOutside="False" IgnoreIfNotInSameSub="False" IgnoreIncapacitated="False" Threshold="0" ThresholdMin="-1" ThresholdMax="-1" PerceptionDistanceMultiplier="1" MaxPerceptionDistance="-1" Offset="0,0" AttackPattern="Straight" PrioritizeSubCenter="False" SweepDistance="0" SweepStrength="10" SweepSpeed="1" CircleStartDistance="5000" IgnoreTargetSize="False" CircleRotationSpeed="1" DynamicCircleRotationSpeed="False" CircleRandomRotationFactor="0" CircleStrikeDistanceMultiplier="5" CircleMaxRandomOffset="0" />
      <!-- Sometimes you have to manually define monsters by species, its a whole thing... -->
      <target Tag="mudraptor" State="Attack" Priority="400" ReactDistance="1000" AttackDistance="1000" Timer="0" IgnoreContained="False" IgnoreInside="False" IgnoreOutside="False" IgnoreTargetInside="False" IgnoreTargetOutside="False" IgnoreIfNotInSameSub="False" IgnoreIncapacitated="False" Threshold="0" ThresholdMin="-1" ThresholdMax="-1" PerceptionDistanceMultiplier="1" MaxPerceptionDistance="-1" Offset="0,0" AttackPattern="Straight" PrioritizeSubCenter="False" SweepDistance="0" SweepStrength="10" SweepSpeed="1" CircleStartDistance="5000" IgnoreTargetSize="False" CircleRotationSpeed="1" DynamicCircleRotationSpeed="False" CircleRandomRotationFactor="0" CircleStrikeDistanceMultiplier="5" CircleMaxRandomOffset="0" />
      <target Tag="tigerthresher" State="Attack" Priority="400" ReactDistance="1000" AttackDistance="1000" Timer="0" IgnoreContained="False" IgnoreInside="False" IgnoreOutside="False" IgnoreTargetInside="False" IgnoreTargetOutside="False" IgnoreIfNotInSameSub="False" IgnoreIncapacitated="False" Threshold="0" ThresholdMin="-1" ThresholdMax="-1" PerceptionDistanceMultiplier="1" MaxPerceptionDistance="-1" Offset="0,0" AttackPattern="Straight" PrioritizeSubCenter="False" SweepDistance="0" SweepStrength="10" SweepSpeed="1" CircleStartDistance="5000" IgnoreTargetSize="False" CircleRotationSpeed="1" DynamicCircleRotationSpeed="False" CircleRandomRotationFactor="0" CircleStrikeDistanceMultiplier="5" CircleMaxRandomOffset="0" />
      <target Tag="weaker" State="Attack" Priority="300" ReactDistance="1000" AttackDistance="1000" Timer="0" IgnoreContained="False" IgnoreInside="False" IgnoreOutside="False" IgnoreTargetInside="False" IgnoreTargetOutside="False" IgnoreIfNotInSameSub="False" IgnoreIncapacitated="False" Threshold="0" ThresholdMin="-1" ThresholdMax="-1" PerceptionDistanceMultiplier="1" MaxPerceptionDistance="-1" Offset="0,0" AttackPattern="Straight" PrioritizeSubCenter="False" SweepDistance="0" SweepStrength="10" SweepSpeed="1" CircleStartDistance="5000" IgnoreTargetSize="False" CircleRotationSpeed="1" DynamicCircleRotationSpeed="False" CircleRandomRotationFactor="0" CircleStrikeDistanceMultiplier="5" CircleMaxRandomOffset="0" />
      <target Tag="human" State="Follow" Priority="50" ReactDistance="1500" AttackDistance="0" Timer="0" IgnoreContained="False" IgnoreInside="False" IgnoreOutside="False" IgnoreTargetInside="False" IgnoreTargetOutside="False" IgnoreIfNotInSameSub="False" IgnoreIncapacitated="False" Threshold="0" ThresholdMin="-1" ThresholdMax="-1" PerceptionDistanceMultiplier="1" MaxPerceptionDistance="-1" Offset="0,0" AttackPattern="Straight" PrioritizeSubCenter="False" SweepDistance="0" SweepStrength="10" SweepSpeed="1" CircleStartDistance="5000" IgnoreTargetSize="False" CircleRotationSpeed="1" DynamicCircleRotationSpeed="False" CircleRandomRotationFactor="0" CircleStrikeDistanceMultiplier="5" CircleMaxRandomOffset="0" />
      <petbehavior maxhappiness="100" happinessdecreaserate="0" hungerincreaserate="0" playforce="0" />
    </ai>
    <damageemitter drawontop="True" Particle="shrapnel" AngleMin="0" AngleMax="360" ScaleMin="1" ScaleMax="2" VelocityMin="50" VelocityMax="300" EmitInterval="0" ParticlesPerSecond="0" ParticleAmount="5" HighQualityCollisionDetection="False" CopyEntityAngle="False" />
    <damageemitter drawontop="True" Particle="weldspark" AngleMin="0" AngleMax="360" ScaleMin="1.5" ScaleMax="2" VelocityMin="50" VelocityMax="600" EmitInterval="0" ParticlesPerSecond="0" ParticleAmount="5" HighQualityCollisionDetection="False" CopyEntityAngle="False" />
    <bloodemitter Particle="blackwaterblood" AngleMin="1" AngleMax="2" ScaleMin="1" ScaleMax="1" VelocityMin="0" VelocityMax="0" EmitInterval="0" ParticlesPerSecond="0" ParticleAmount="10" HighQualityCollisionDetection="False" CopyEntityAngle="False" />
    <bloodemitter drawontop="True" Particle="weldspark" AngleMin="0" AngleMax="360" ScaleMin="1.5" ScaleMax="2" VelocityMin="50" VelocityMax="600" EmitInterval="0" ParticlesPerSecond="0" ParticleAmount="5" HighQualityCollisionDetection="False" CopyEntityAngle="False" />
    <StatusEffect type="Always" target="Character">
      <Affliction identifier="ekR_drone_noiff" strength="200" />
      <ReduceAffliction identifier="organdamage" amount="200" />
      <ReduceAffliction identifier="bloodloss" amount="200" />
      <ReduceAffliction identifier="stun" amount="100" />
      <ReduceAffliction identifier="radiationsickness" amount="200" />
      <ReduceAffliction identifier="poison" amount="200" />
    </StatusEffect>
    <!--<StatusEffect type="OnDeath">
    <Explosion range="200.0" structuredamage="10" itemdamage="35" stun="1" force="15.0" severlimbsprobability="0">
	  <sound file="Content/Items/Weapons/ExplosionMedium2.ogg" type="OnUse" range="2500" selectionmode="All" />
	  <sound file="Content/Items/Weapons/ExplosionDebris2.ogg" type="OnUse" range="2000" />
    </Explosion>
  </StatusEffect>-->
    <StatusEffect type="OnDeath" target="This" disabledeltatime="true" stackable="false" delay="0.15">
      <Explosion range="200.0" structuredamage="10" itemdamage="35" stun="1" force="15.0" severlimbsprobability="0.5" decal="explosion" decalsize="0.5">
        <sound file="Content/Items/Weapons/ExplosionMedium2.ogg" type="OnUse" range="2500" selectionmode="All" />
        <sound file="Content/Items/Weapons/ExplosionDebris2.ogg" type="OnUse" range="2000" />
        <Affliction identifier="burn" strength="60" />
        <Affliction identifier="internaldamage" strength="80" />
        <Affliction identifier="bleeding" strength="25" />
      </Explosion>
      <SpawnItem identifier="ek_gundrone_wreck" spawnposition="This" />
      <RemoveCharacter />
    </StatusEffect>
    <!--
  <StatusEffect type="Always" targettype="This" comparison="or">
    <Conditional hastag="ek_drone_disarm_tag"/>
    <Conditional hasStatusTag="ek_drone_disarm_tag"/>
    <Conditional HasStatusEffect="ek_drone_disarm" />
    <Sound file="Mods/EK Armory/Items/Weapons/ek_impactmine_disarmed.ogg" range="1500" />
    <SpawnItem identifier="ek_gundrone" spawnposition="This"/>
    <RemoveCharacter />
  </StatusEffect>-->
    <!-- Recover drones using status-effect | Todo: Wait for this to work -->
    <StatusEffect type="OnActive" target="this" setvalue="true">
      <Conditional ekR_drone_disarm="gte 25" />
      <Affliction identifier="stun" strength="3.0" />
    </StatusEffect>
    <StatusEffect type="OnActive" target="this" Interval="1.0">
      <Conditional ekR_drone_disarm="gte 90" />
      <Sound file="%ModDir%/Items/Weapons/ek_drone_disarm.ogg" range="500" volume="0.7" />
      <SpawnItem identifier="ek_gundrone" spawnposition="This" />
      <RemoveCharacter />
    </StatusEffect>
  </Character>
</Override>